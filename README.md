# MAILGANER - тестовое задание

### Задание
См. [issue](https://github.com/vlad397/mailganer_test/issues)

### Описание

Возможности проекта:

- отправка рассылок с использованием html-шаблона с динамическими данными;
- отправка отложенных рассылок;
- отслеживание открытия писем;
- отписка от рассылки;

### Подробности выполнения

Создано три модели: `User`, `Mailing`, `MailingUser`(для связи M2M).
Поля модели `User`:
- email;
- username;
- first_name;
- last_name;
- is_subscribed - подписан ли пользователь на рассылку;

Поля модели `Mailing`:
- name - название рассылки;
- subject - тема рассылки;
- body - тело рассылки;
- users - поле для отображения пользователей, которым была отправлена рассылка (при создании его заполнять не нужно);
- sending_time - время отправки рассылки (если пустое, то рассылка будет отправлена немедленно);

Поля модели `MailingUser`:
- user - FK пользователя;
- mailing - FK рассылки;
- is_seen - была ли просмотрена рассылка пользователем;

При создании рассылки на панели администратора сработает `post_save()` сигнал по модели `Mailing`, который возьмет
всех подписанных на рассылку пользователей и создат объекты промежуточной модели `MailingUser`. Далее будет создан
массив сгенерированных писем под каждого пользователя. Если указано `sending_time`, то рассылка будет отправлена в
очередь `RabbitMQ` для дальнейшего выполнения воркером `Celery`, иначе рассылка будет отправлена немедленно.

В шаблоне кроме прочей информации присутствуют две ссылки: `ссылка на отписку от рассылки` и `ссылка на подтверждение`
`просмотра`. По поводу `подтверждения просмотра` - был вариант однопиксельного js-кода, который срабатывает при 
открытии письма, однако почтовые сервисы не пропускают такой вариант.


### Запуск проекта
После клонирования репозитария создайте `.env` файл на уровне с `env_sample.txt` - шаблона env-файла

Для установки Docker используйте команду `sudo apt install docker docker-compose`

Далее выполните следующие команды:

`sudo docker-compose up -d --build` *Для запуска сборки контейнеров*

`sudo docker-compose exec backend python manage.py makemigrations` *Для создания миграций*

`sudo docker-compose exec backend python manage.py migrate` *Для применения миграций*

`sudo docker-compose exec backend python manage.py createsuperuser` *Для создания суперпользователя*

Админка доступна по адресу http://127.0.0.1:8000/admin/ (NGINX в данном проекте не используется)